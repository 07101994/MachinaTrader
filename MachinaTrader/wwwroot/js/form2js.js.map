{"version":3,"sources":["src/form2js.js"],"names":["root","factory","define","amd","form2js","skipHidden","rootNode","delimiter","skipEmpty","nodeCallback","skipHiddenVar","useIdIfEmptyName","arguments","length","document","getElementById","formValues","currNode","i","constructor","Array","NodeList","concat","getFormValues","processNameValues","nameValues","result","arrays","j","k","l","value","nameParts","currResult","arrNameFull","arrName","arrIdx","namePart","name","_nameParts","split","match","push","indexOf","substr","replace","test","extractNodeValues","getSubFormValues","currentNode","firstChild","nextSibling","node","fieldValue","fieldName","getFieldName","callbackResult","nodeName","getFieldValue","id","getFieldValueType","fieldNode","$","hasClass","parseFloat","parseInt","selectedValues","each","val","String","is","disabled","type","toLowerCase","getSelectedOptionValue","checked","selectNode","multiple","options","getElementsByTagName","selected"],"mappings":"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","sourcesContent":["/**\r\n * Copyright (c) 2018 Thiemo Borger\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n *\r\n * @author Thiemo Borger\r\n * Date: 20.07.2018\r\n * Time: 06:05:00\r\n */\r\n\r\n( function(root, factory) {\r\n\t\tif ( typeof define === 'function' && define.amd) {\r\n\t\t\t// AMD. Register as an anonymous module.\r\n\t\t\tdefine(factory);\r\n\t\t} else {\r\n\t\t\t// Browser globals\r\n\t\t\troot.form2js = factory();\r\n\t\t}\r\n\t}(this, function() {\"use strict\";\r\n\r\n\t\t/**\r\n\t\t * Returns form values represented as Javascript object\r\n\t\t * \"name\" attribute defines structure of resulting object\r\n\t\t *\r\n\t\t * @param rootNode {Element|String} root form element (or it's id) or array of root elements\r\n\t\t * @param delimiter {String} structure parts delimiter defaults to '.'\r\n\t\t * @param skipEmpty {Boolean} should skip empty text values, defaults to true\r\n\t\t * @param nodeCallback {Function} custom function to get node value\r\n\t\t * @param useIdIfEmptyName {Boolean} if true value of id attribute of field will be used if name of field is empty\r\n\t\t */\r\n\r\n\t\tvar skipHidden = false;\r\n\t\tfunction form2js(rootNode, delimiter, skipEmpty, nodeCallback, skipHiddenVar, useIdIfEmptyName) {\r\n\t\t\tif ( typeof skipEmpty === 'undefined' || skipEmpty === null)\r\n\t\t\t\tskipEmpty = true;\r\n\t\t\tif ( typeof delimiter === 'undefined' || delimiter === null)\r\n\t\t\t\tdelimiter = '.';\r\n\t\t\tif (arguments.length < 5)\r\n\t\t\t\tuseIdIfEmptyName = false;\r\n\t\t\t\tskipHidden = skipHiddenVar;\r\n\t\t\tif (arguments.length < 6)\r\n\t\t\t\tuseIdIfEmptyName = false;\r\n\r\n\t\t\trootNode = typeof rootNode === 'string' ? document.getElementById(rootNode) : rootNode;\r\n\r\n\t\t\tvar formValues = [], currNode, i = 0;\r\n\r\n\t\t\t/* If rootNode is array - combine values */\r\n\t\t\tif (rootNode.constructor === Array || ( typeof NodeList !== \"undefined\" && rootNode.constructor === NodeList)) {\r\n\t\t\t\twhile (currNode === rootNode[i++]) {\r\n\t\t\t\t\tformValues = formValues.concat(getFormValues(currNode, nodeCallback, useIdIfEmptyName));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tformValues = getFormValues(rootNode, nodeCallback, useIdIfEmptyName);\r\n\t\t\t}\r\n\r\n\t\t\treturn processNameValues(formValues, skipEmpty, delimiter);\r\n\t\t}\r\n\r\n\t\tfunction processNameValues(nameValues, skipEmpty, delimiter) {\r\n\t\t\tvar result = {}, arrays = {}, i, j, k, l, value, nameParts, currResult, arrNameFull, arrName, arrIdx, namePart, name, _nameParts;\r\n\r\n\t\t\tfor ( i = 0; i < nameValues.length; i++) {\r\n\t\t\t\tvalue = nameValues[i].value;\r\n\r\n                if (value === 'FORCE_EMPTY_NULL') {\r\n                    value = null;\r\n                }\r\n\r\n\t\t\t\telse if (value === 'FORCE_EMPTY_STRING') {\r\n\t\t\t\t\tvalue = \"\";\r\n\t\t\t\t} else if (skipEmpty && (value === '' || value === null)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tname = nameValues[i].name;\r\n\t\t\t\t_nameParts = name.split(delimiter);\r\n\t\t\t\tnameParts = [];\r\n\t\t\t\tcurrResult = result;\r\n\t\t\t\tarrNameFull = '';\r\n\r\n\t\t\t\tfor ( j = 0; j < _nameParts.length; j++) {\r\n\t\t\t\t\tnamePart = _nameParts[j].split('][');\r\n\t\t\t\t\tif (namePart.length > 1) {\r\n\t\t\t\t\t\tfor ( k = 0; k < namePart.length; k++) {\r\n\t\t\t\t\t\t\tif (k === 0) {\r\n\t\t\t\t\t\t\t\tnamePart[k] = namePart[k] + ']';\r\n\t\t\t\t\t\t\t} else if (k === namePart.length - 1) {\r\n\t\t\t\t\t\t\t\tnamePart[k] = '[' + namePart[k];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnamePart[k] = '[' + namePart[k] + ']';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tarrIdx = namePart[k].match(/([a-z_]+)?\\[([a-z_][a-z0-9_]+?)\\]/i);\r\n\t\t\t\t\t\t\tif (arrIdx) {\r\n\t\t\t\t\t\t\t\tfor ( l = 1; l < arrIdx.length; l++) {\r\n\t\t\t\t\t\t\t\t\tif (arrIdx[l])\r\n\t\t\t\t\t\t\t\t\t\tnameParts.push(arrIdx[l]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnameParts.push(namePart[k]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t\tnameParts = nameParts.concat(namePart);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( j = 0; j < nameParts.length; j++) {\r\n\t\t\t\t\tnamePart = nameParts[j];\r\n\r\n\t\t\t\t\tif (namePart.indexOf('[]') > -1 && j === nameParts.length - 1) {\r\n\t\t\t\t\t\tarrName = namePart.substr(0, namePart.indexOf('['));\r\n\t\t\t\t\t\tarrNameFull += arrName;\r\n\r\n\t\t\t\t\t\tif (!currResult[arrName])\r\n\t\t\t\t\t\t\tcurrResult[arrName] = [];\r\n\t\t\t\t\t\tcurrResult[arrName].push(value);\r\n\t\t\t\t\t} else if (namePart.indexOf('[') > -1) {\r\n\t\t\t\t\t\tarrName = namePart.substr(0, namePart.indexOf('['));\r\n\t\t\t\t\t\tarrIdx = namePart.replace(/(^([a-z_]+)?\\[)|(\\]$)/gi, '');\r\n\r\n\t\t\t\t\t\t/* Unique array name */\r\n\t\t\t\t\t\tarrNameFull += '_' + arrName + '_' + arrIdx;\r\n\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t * Because arrIdx in field name can be not zero-based and step can be\r\n\t\t\t\t\t\t * other than 1, we can't use them in target array directly.\r\n\t\t\t\t\t\t * Instead we're making a hash where key is arrIdx and value is a reference to\r\n\t\t\t\t\t\t * added array element\r\n\t\t\t\t\t\t */\r\n\r\n\t\t\t\t\t\tif (!arrays[arrNameFull])\r\n\t\t\t\t\t\t\tarrays[arrNameFull] = {};\r\n\t\t\t\t\t\tif (arrName !== '' && !currResult[arrName])\r\n\t\t\t\t\t\t\tcurrResult[arrName] = [];\r\n\r\n\t\t\t\t\t\tif (j === nameParts.length - 1) {\r\n\t\t\t\t\t\t\tif (arrName === '') {\r\n\t\t\t\t\t\t\t\tcurrResult.push(value);\r\n\t\t\t\t\t\t\t\tarrays[arrNameFull][arrIdx] = currResult[currResult.length - 1];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tcurrResult[arrName].push(value);\r\n\t\t\t\t\t\t\t\tarrays[arrNameFull][arrIdx] = currResult[arrName][currResult[arrName].length - 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (!arrays[arrNameFull][arrIdx]) {\r\n\t\t\t\t\t\t\t\tif ((/^[a-z_]+\\[?/i).test(nameParts[j + 1]))\r\n\t\t\t\t\t\t\t\t\tcurrResult[arrName].push({});\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\tcurrResult[arrName].push([]);\r\n\r\n\t\t\t\t\t\t\t\tarrays[arrNameFull][arrIdx] = currResult[arrName][currResult[arrName].length - 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcurrResult = arrays[arrNameFull][arrIdx];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tarrNameFull += namePart;\r\n\r\n\t\t\t\t\t\tif (j < nameParts.length - 1)/* Not the last part of name - means object */\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (!currResult[namePart])\r\n\t\t\t\t\t\t\t\tcurrResult[namePart] = {};\r\n\t\t\t\t\t\t\tcurrResult = currResult[namePart];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcurrResult[namePart] = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tfunction getFormValues(rootNode, nodeCallback, useIdIfEmptyName) {\r\n\t\t\tvar result = extractNodeValues(rootNode, nodeCallback, useIdIfEmptyName);\r\n\t\t\treturn result.length > 0 ? result : getSubFormValues(rootNode, nodeCallback, useIdIfEmptyName);\r\n\t\t}\r\n\r\n\t\tfunction getSubFormValues(rootNode, nodeCallback, useIdIfEmptyName) {\r\n\t\t\tvar result = [], currentNode = rootNode.firstChild;\r\n\r\n\t\t\twhile (currentNode) {\r\n\t\t\t\tresult = result.concat(extractNodeValues(currentNode, nodeCallback, useIdIfEmptyName));\r\n\t\t\t\tcurrentNode = currentNode.nextSibling;\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tfunction extractNodeValues(node, nodeCallback, useIdIfEmptyName) {\r\n\t\t\tvar fieldValue, result, fieldName = getFieldName(node, useIdIfEmptyName);\r\n\r\n\t\t\tvar callbackResult = nodeCallback && nodeCallback(node);\r\n\r\n\t\t\tif (callbackResult && callbackResult.name) {\r\n\t\t\t\tresult = [callbackResult];\r\n\t\t\t} else if (fieldName !== '' && node.nodeName.match(/INPUT|TEXTAREA/i)) {\r\n\t\t\t\tfieldValue = getFieldValue(node);\r\n\t\t\t\tresult = [{\r\n\t\t\t\t\tname : fieldName,\r\n\t\t\t\t\tvalue : fieldValue\r\n\t\t\t\t}];\r\n\t\t\t} else if (fieldName !== '' && node.nodeName.match(/SELECT/i)) {\r\n\t\t\t\tfieldValue = getFieldValue(node);\r\n\t\t\t\tresult = [{\r\n\t\t\t\t\tname : fieldName.replace(/\\[\\]$/, ''),\r\n\t\t\t\t\tvalue : fieldValue\r\n\t\t\t\t}];\r\n\t\t\t} else {\r\n\t\t\t\tresult = getSubFormValues(node, nodeCallback, useIdIfEmptyName);\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tfunction getFieldName(node, useIdIfEmptyName) {\r\n\t\t\tif (node.name && node.name !== '')\r\n\t\t\t\treturn node.name;\r\n\t\t\telse if (useIdIfEmptyName && node.id && node.id !== '')\r\n\t\t\t\treturn node.id;\r\n\t\t\telse\r\n\t\t\t\treturn '';\r\n        }\r\n\r\n        function getFieldValueType(fieldNode)\r\n        {\r\n            if ($(fieldNode).hasClass(\"float\")) {\r\n                return parseFloat(fieldNode.value);\r\n            }\r\n            if ($(fieldNode).hasClass(\"integer\")) {\r\n                return parseInt(fieldNode.value);\r\n            }\r\n            /*if ($(fieldNode).hasClass(\"array\")) {\r\n                return fieldNode.value.split(\",\");\r\n            }*/\r\n            if ($(fieldNode).hasClass(\"array\")) {\r\n                var selectedValues = [];\r\n                $(fieldNode).each(function () {\r\n                    selectedValues.push($(this).val());\r\n                });\r\n                return selectedValues;\r\n            }\r\n            if ($(fieldNode).hasClass(\"bool\")) {\r\n                if (fieldNode.value === \"true\" || fieldNode.value === \"on\" || fieldNode.value === \"checked\") {\r\n                    return true;\r\n                } else if (fieldNode.value === \"false\" || fieldNode.value === \"off\" || fieldNode.value === \"unchecked\") {\r\n                    return false;\r\n                } else {\r\n                    return fieldNode.value;\r\n                }\r\n            }\r\n            if ($(fieldNode).hasClass(\"string\")) {\r\n                if ((fieldNode.value === '' || fieldNode.value === null)) {\r\n                    return String(\"FORCE_EMPTY_STRING\");\r\n                } else {\r\n                    return fieldNode.value;\r\n                }\r\n            }\r\n            return fieldNode.value;\r\n        }\r\n\r\n\t\tfunction getFieldValue(fieldNode) {\r\n            if (skipHidden)\r\n            {\r\n                if (!$(fieldNode).is(\":visible\") && !$(fieldNode).hasClass(\"form2jsEnable\"))\r\n                return null;\r\n            }\r\n\r\n\t\t\tif (fieldNode.disabled && !$(fieldNode).hasClass(\"form2jsEnable\"))\r\n\t\t\t\treturn null;\r\n\t\t\t\r\n\t\t\tif ($(fieldNode).hasClass(\"form2jsDisable\"))\r\n\t\t\t\treturn null;\t\t\t\r\n\r\n            switch (fieldNode.type.toLowerCase()) {\r\n                case 'text':\r\n                    return (getFieldValueType(fieldNode));\r\n                case 'hidden':\r\n                    return (getFieldValueType(fieldNode));\r\n                case 'textarea':\r\n                    return (getFieldValueType(fieldNode));\r\n                case 'select':\r\n                    return getSelectedOptionValue(fieldNode);\n                case 'select-multiple':\r\n                    return getSelectedOptionValue(fieldNode);\r\n                case 'radio':\r\n                    if (!fieldNode.checked)\r\n                        return null;\r\n                    if (fieldNode.checked && fieldNode.value === \"false\")\r\n                        return false;\r\n                    return fieldNode.value;\r\n                case 'checkbox':\r\n                    if ($(fieldNode).hasClass(\"bool\")) {\r\n                        if (fieldNode.checked) {\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    } else {\r\n                        if (fieldNode.checked && fieldNode.value === \"null\")\r\n                            return String(\"FORCE_EMPTY_NULL\");\r\n                        if (fieldNode.checked && fieldNode.value === \"true\")\r\n                            return true;\r\n                        if (!fieldNode.checked && fieldNode.value === \"true\")\r\n                            return false;\r\n                        if (fieldNode.checked)\r\n                            return fieldNode.value;\r\n                    }\r\n                    break;\r\n                case 'button':\r\n                case 'reset':\r\n                case 'submit':\r\n                case 'image':\r\n                    return null;\r\n                default:\r\n                    return fieldNode.value;\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tfunction getSelectedOptionValue(selectNode) {\r\n\t\t\tvar multiple = selectNode.multiple, result = [], options, i, l;\r\n\r\n\t\t\tif (!multiple) {\r\n\t\t\t\tif ($(selectNode).hasClass( \"float\" )) {\r\n\t\t\t\t\treturn parseFloat(selectNode.value);\r\n\t\t\t\t}\r\n\t\t\t\tif ($(selectNode).hasClass( \"integer\" )) {\r\n\t\t\t\t\treturn parseInt(selectNode.value);\r\n\t\t\t\t}\r\n\t\t\t\treturn selectNode.value;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( options = selectNode.getElementsByTagName(\"option\"), i = 0, l = options.length; i < l; i++) {\r\n\t\t\t\tif (options[i].selected)\r\n\t\t\t\t\tresult.push(options[i].value);\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\treturn form2js;\r\n\r\n\t}));\r\n"],"file":"form2js.js"}